<!DOCTYPE html>
<html lang="en">
<head>
	<title>HW2 - Part A</title>
	<meta charset="utf-8">
	<style>body {margin: 0px; overflow: hidden;} #heightmap-canvas {display: none;}</style>
</head>
<body>
	<div id="container"></div>
	<canvas id='heightmap-canvas'></canvas>
	
	<script src="js/three.min.js"></script>
	<script src="js/OrbitControls.js"></script>
	<script src="js/perlin.js"></script>
    <script id="terrainVS" type="x-shader/x-vertex">

	uniform mat4 modelMatrix;
	uniform mat4 viewMatrix;
    uniform mat4 projectionMatrix;
	uniform sampler2D tPic;

    attribute vec3 position;
	attribute vec2 uv;
	attribute vec3 normal;

	uniform float displaceAmt; //controls the amount of vertex displacement...
	
    varying float vDisplace; 
	varying vec2 vUv;

    precision mediump float;

	void main() {
		vUv = uv;
		
		vec4 clr = texture2D(tPic, uv);
		vDisplace = clr.r * displaceAmt; //displacement;
        vec3 newPosition = (position.xyz + normal.xyz * vDisplace).xyz;
      
       	gl_Position = projectionMatrix  * viewMatrix * modelMatrix  * vec4( newPosition, 1.0 );
    }
	</script>

	<script id="terrainFS" type="x-shader/x-fragment">

      precision mediump float;

      uniform sampler2D tGrass, tSnow, tHill;


      varying vec2 vUv;
      varying float vDisplace; 


      void main() {

	vec4 grass = texture2D(tGrass, vUv);
	vec4 snow = texture2D(tSnow, vUv);
	vec4 hill = texture2D(tHill, vUv);

	float zOffset = vDisplace;

	vec4 mix1 = mix(grass, hill, min(1.0,zOffset*8.0));
	vec4 mix2 = max(vec4(1.0), mix(hill, snow, zOffset) * 1.5);
	vec4 mix3 = mix(mix1, mix2, zOffset);


	gl_FragColor = vec4( mix3.rgb, 1.0 );        

   }

	</script>
	
	<script src="js/a.js"></script>
</body>
</html>

